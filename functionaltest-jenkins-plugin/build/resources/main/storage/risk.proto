syntax = "proto3";

option go_package = "storage";
option java_package = "io.stackrox.proto.storage";


package storage;

message Risk {
    string id                       = 1;
    RiskSubject subject             = 2;
    float score                     = 3 ;

    message Result {
        message Factor {
            string message          = 1;
            string url              = 2;
        }
        string name                 = 1 ;
        repeated Factor factors     = 2;
        float score                 = 3;
    }
    repeated Result results         = 4;
}

message RiskSubject {
    string id                   = 1;
    string namespace            = 2 ;
    string cluster_id           = 3 ;
    RiskSubjectType type        = 4 ;
}

enum RiskSubjectType {
    UNKNOWN                 = 0;
    DEPLOYMENT              = 1;
    NAMESPACE               = 2;
    CLUSTER                 = 3;
    IMAGE                   = 4;
    IMAGE_COMPONENT         = 6;
    SERVICEACCOUNT          = 5;
}
